{"version":3,"file":"caniuse-webp.min.js","sources":["../lib/index.js"],"sourcesContent":["// ref: https://developers.google.com/speed/webp/faq\nexport const features = [\n  'lossy',\n  'lossless',\n  'alpha',\n  'animation',\n]\n\nexport function checkWebpFeature(feature, callback) {\n  let kTestImages = {\n    lossy: 'UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA',\n    lossless: 'UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==',\n    alpha: 'UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==',\n    animation: 'UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA',\n    all: true\n  }\n  let img = new Image()\n  img.onload = function () {\n    let result = (img.width > 0) && (img.height > 0)\n    callback(result)\n  }\n  img.onerror = function () {\n    callback(false)\n  }\n  img.src = 'data:image/webp;base64,' + kTestImages[feature]\n}\n\n\n\n// default check lossy\n// if no callback, will return a promise\nexport default function caniuseWebp (feature = 'all', callback) {\n  let result = {}\n  let resolve\n  let p\n\n  if (!callback) {\n    p = new Promise(function (_resolve) {\n      resolve = _resolve\n    })\n  } else {\n    console.log('callback')\n    resolve = function (res) {\n      callback(res)\n    }\n  }\n  \n  if (feature === 'all') { \n    features.forEach((feat, index) => {\n      checkWebpFeature(feat, function (res) {\n        result[feat] = res\n        ++index\n        if (index === features.length) {\n          // all done\n          resolve(result)\n        }\n      })\n    })\n  } else {\n    checkWebpFeature(feature, resolve)\n  }\n\n  if (!callback) return p\n}"],"names":["features","checkWebpFeature","feature","callback","img","Image","onload","result","width","height","onerror","src","lossy","lossless","alpha","animation","all","resolve","p","res","Promise","_resolve","forEach","feat","index","length"],"mappings":"kMACaA,EAAW,CACtB,QACA,WACA,QACA,aAGK,SAASC,EAAiBC,EAASC,OAQpCC,EAAM,IAAIC,MACdD,EAAIE,OAAS,eACPC,EAAsB,EAAZH,EAAII,OAA4B,EAAbJ,EAAIK,OACrCN,EAASI,IAEXH,EAAIM,QAAU,WACZP,GAAS,IAEXC,EAAIO,IAAM,0BAfQ,CAChBC,MAAO,2DACPC,SAAU,mDACVC,MAAO,mHACPC,UAAW,2HACXC,KAAK,GAU2Cd,+CAOrC,SAAsBA,EAAiBC,YAAjBD,IAAAA,EAAU,WAEzCe,EACAC,EAFAX,EAAS,MAIRJ,EAMHc,EAAU,SAAUE,GAClBhB,EAASgB,IANXD,EAAI,IAAIE,QAAQ,SAAUC,GACxBJ,EAAUI,IASE,QAAZnB,EACFF,EAASsB,QAAQ,SAACC,EAAMC,GACtBvB,EAAiBsB,EAAM,SAAUJ,GAC/BZ,EAAOgB,GAAQJ,IACbK,IACYxB,EAASyB,QAErBR,EAAQV,OAKdN,EAAiBC,EAASe,IAGvBd,EAAU,OAAOe"}