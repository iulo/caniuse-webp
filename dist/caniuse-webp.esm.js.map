{"version":3,"file":"caniuse-webp.esm.js","sources":["../lib/index.js"],"sourcesContent":["// ref: https://developers.google.com/speed/webp/faq\nexport const features = [\n  'lossy',\n  'lossless',\n  'alpha',\n  'animation',\n]\n\nexport function checkWebpFeature(feature, callback) {\n  let kTestImages = {\n    lossy: 'UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA',\n    lossless: 'UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==',\n    alpha: 'UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==',\n    animation: 'UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA',\n    all: true\n  }\n  let img = new Image()\n  img.onload = function () {\n    let result = (img.width > 0) && (img.height > 0)\n    callback(result)\n  }\n  img.onerror = function () {\n    callback(false)\n  }\n  img.src = 'data:image/webp;base64,' + kTestImages[feature]\n}\n\n\n\n// default check lossy\n// if no callback, will return a promise\nexport default function caniuseWebp (feature = 'all', callback) {\n  let result = {}\n  let resolve\n  let p\n\n  if (!callback) {\n    p = new Promise(function (_resolve) {\n      resolve = _resolve\n    })\n  } else {\n    console.log('callback')\n    resolve = function (res) {\n      callback(res)\n    }\n  }\n  \n  if (feature === 'all') { \n    features.forEach((feat, index) => {\n      checkWebpFeature(feat, function (res) {\n        result[feat] = res\n        ++index\n        if (index === features.length) {\n          // all done\n          resolve(result)\n        }\n      })\n    })\n  } else {\n    checkWebpFeature(feature, resolve)\n  }\n\n  if (!callback) return p\n}"],"names":["features","checkWebpFeature","feature","callback","kTestImages","lossy","lossless","alpha","animation","all","img","Image","onload","result","width","height","onerror","src","caniuseWebp","resolve","p","Promise","_resolve","console","log","res","forEach","feat","index","length"],"mappings":";;;;;AAAA;AACA,IAAaA,QAAQ,GAAG,CACtB,OADsB,EAEtB,UAFsB,EAGtB,OAHsB,EAItB,WAJsB,CAAjB;AAOP,AAAO,SAASC,gBAAT,CAA0BC,OAA1B,EAAmCC,QAAnC,EAA6C;MAC9CC,WAAW,GAAG;IAChBC,KAAK,EAAE,0DADS;IAEhBC,QAAQ,EAAE,kDAFM;IAGhBC,KAAK,EAAE,kHAHS;IAIhBC,SAAS,EAAE,0HAJK;IAKhBC,GAAG,EAAE;GALP;MAOIC,GAAG,GAAG,IAAIC,KAAJ,EAAV;;EACAD,GAAG,CAACE,MAAJ,GAAa,YAAY;QACnBC,MAAM,GAAIH,GAAG,CAACI,KAAJ,GAAY,CAAb,IAAoBJ,GAAG,CAACK,MAAJ,GAAa,CAA9C;IACAZ,QAAQ,CAACU,MAAD,CAAR;GAFF;;EAIAH,GAAG,CAACM,OAAJ,GAAc,YAAY;IACxBb,QAAQ,CAAC,KAAD,CAAR;GADF;;EAGAO,GAAG,CAACO,GAAJ,GAAU,4BAA4Bb,WAAW,CAACF,OAAD,CAAjD;;;;AAOF,AAAe,SAASgB,WAAT,CAAsBhB,OAAtB,EAAuCC,QAAvC,EAAiD;MAA3BD,OAA2B;IAA3BA,OAA2B,GAAjB,KAAiB;;;MAC1DW,MAAM,GAAG,EAAb;MACIM,OAAJ;MACIC,CAAJ;;MAEI,CAACjB,QAAL,EAAe;IACbiB,CAAC,GAAG,IAAIC,OAAJ,CAAY,UAAUC,QAAV,EAAoB;MAClCH,OAAO,GAAGG,QAAV;KADE,CAAJ;GADF,MAIO;IACLC,OAAO,CAACC,GAAR,CAAY,UAAZ;;IACAL,OAAO,GAAG,iBAAUM,GAAV,EAAe;MACvBtB,QAAQ,CAACsB,GAAD,CAAR;KADF;;;MAKEvB,OAAO,KAAK,KAAhB,EAAuB;IACrBF,QAAQ,CAAC0B,OAAT,CAAiB,UAACC,IAAD,EAAOC,KAAP,EAAiB;MAChC3B,gBAAgB,CAAC0B,IAAD,EAAO,UAAUF,GAAV,EAAe;QACpCZ,MAAM,CAACc,IAAD,CAAN,GAAeF,GAAf;UACEG,KAAF;;YACIA,KAAK,KAAK5B,QAAQ,CAAC6B,MAAvB,EAA+B;;UAE7BV,OAAO,CAACN,MAAD,CAAP;;OALY,CAAhB;KADF;GADF,MAWO;IACLZ,gBAAgB,CAACC,OAAD,EAAUiB,OAAV,CAAhB;;;MAGE,CAAChB,QAAL,EAAe,OAAOiB,CAAP;;;;;;"}